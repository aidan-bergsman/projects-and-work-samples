---
title: "Athletic Wear Sales Analytics Project"
author: "Aidan Bergsman"
date: "2023-09-28"
output:
  html_document:
    theme: journal
    highlight: haddock
    toc: yes
    toc_depth: 3
    toc_float: yes
    keep_md: true
---

# Introduction

This project began as an extension of a DataCamp course on business analytics using Microsoft Excel. The course used an Excel Workbook with global sales and client data for athletic wear and taught how to create basic graphs and tables in Excel. After completing the course, I challenged myself to see if I could recreate the graphs and tables using RStudio, which is my analytics tool of choice.

After completing this challenge, I went a step further and added to my analytics by creating interactive graphs and global heat maps of sales to add even more analytics and insight to a potential colleague, boss, or investor. Below are the various graphs and tables with ample descriptions of what I created and why I thought it was important.

# Data

The data used for the following analytics comes from a DataCamp course on Microsoft Excel, which can be found [here](https://assets.datacamp.com/production/repositories/6317/datasets/2e57fe9fc676c640aab6d1c20f2ab0dfe9cd2ca3/Data%20Preparation%20in%20Excel.pdf). I completed the first chapter of the course, which walks through data cleaning, sheet renaming, and sheet reorganization, which is necessary to complete prior to following along with my analytics below (the first chapter of the DataCamp course is free to complete). After completing the course, I decided to load in the **"Orders"** sheet from the DataCamp workbook to conduct my analytics.

```{r}
# load in pacman
library(pacman)

# load in necessary packages
p_load(readxl,janitor,ggplot2)

# load in orders sheet from DataCamp Workbook
sales_data <- read_excel("~/github_repos/projects-and-work-samples/athletic_wear_sales_analytics_project_files/data/sales_data.xlsx",
                         sheet = "Orders")
sales_data
```

## Cleaning column headers 
The data above contains all sorts of categorical and numerical data regarding individual orders of athletic wear. Lots of potential for analytics! Next, I will clean the data a bit, focusing on the column titles and making them more r-friendly (meaning lowercase letters and underscores instead of spaces). I will use the `janitor` package to quickly clean the column names using the `clean_names()` function.

```{r}
#clean column names
sales_data <- clean_names(sales_data)

# view data
sales_data
```

Now the column headers are all lowercase and have underscores instead of spaces!

## Converting `order_date` variable from numeric to date

# Graphs

## Africa total sales over time

Now that the data is clean and easier to work with, I want to see how total annual sales have changed in certain markets. First I will look at the sales in Africa.

```{r}
sales_data %>% 
  # filter for only observations in Africa
  filter(market=="Africa") %>% 
  # group by order year so we can plot one point for each year
  group_by(order_year) %>% 
  # create a sum of the 'sales' column after grouping by each year to obtain the total sales in each year
  mutate(total_annual_sales = sum(sales)) %>% 
  # create graph
  ggplot(mapping = aes(x = order_year, 
                       y = total_annual_sales)) +
  geom_point(color = "firebrick", size = 3) +
  geom_line(color = "firebrick", size = 1.5) +
  # use 'ggthemes' package to add a professional looking theme to the graph
  theme_stata() +
  # add labels and title
  labs(title = "Annual Sales in Africa",
       x = "Year",
       y = "Total Annual Sales (USD)")
  
```

Looks like Africa only has two years worth of data, in 2016 and 2017, and it's clear that sales declined over that time period from just over $40,000 down to about $3,000, which is a substantial drop.

## Europe total sales over time

Next, I want to look at the annual sales in Europe:

```{r}
sales_data %>% 
  # filter for European observations
  filter(market == "Europe") %>% 
  # group by 'order_year' to calculate total sales per each year
  group_by(order_year) %>% 
  # Create total_sales value that is sum of sales in each year
  mutate(total_annual_sales = sum(sales)) %>% 
  # create graph
  ggplot(aes(x = order_year,
             y = total_annual_sales)) +
  geom_point(color = "steelblue3",
             size = 3) +
  geom_line(color = "steelblue3",
            size = 1.5) +
  # add theme using 'ggthemes' package
  theme_stata() +
  # add labels
  labs(title = "Annual Sales in Europe",
       x = "Year",
       y = "Total Annual Sales")
```

Europe has one more years worth of data than Africa, with data from 2015-2017, and has additional volatility over that time period. Sales initially declined from 2015 to 2016, dropping from about $22,000 down to almost $2,000. However, sales begin to rise after 2016, reaching just about $3,000 then.